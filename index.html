<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#111827" />
  <title>Discrete LPF Coefficients</title>
  <!-- Open Graph / Social Media -->
  <meta property="og:title" content="Filter Wizard – Discrete LPF Coefficients" />
  <meta property="og:description" content="A web-based tool for calculating discrete filter coefficients" />
  <meta property="og:image" content="icon.svg" />
  <meta property="og:type" content="website" />
  
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="icon.svg" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="title">
      <div class="logo">∑</div>
      <div>
        <h1>Discrete Filter Coefficients</h1>
        <p>Order 1 / 2 Low-Pass (Butterworth)</p>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Inputs</h2>

      <div class="grid">
        <label>
          Filter order
          <select id="order">
            <option value="1">1st order (1 pole)</option>
            <option value="2" selected>2nd order (biquad Butterworth)</option>
          </select>
        </label>

        <label>
          Cutoff frequency (Hz)
          <input id="fc" type="number" inputmode="decimal" min="0" step="0.1" value="10" />
        </label>

        <label>
          Sampling time Ts (s)
          <input id="ts" type="number" inputmode="decimal" min="0" step="0.0001" value="0.01" />
        </label>
      </div>

      <div class="row">
        <button id="calcBtn" class="primary">Calculate</button>
        <button id="copyBtn" class="secondary" disabled>Copy text</button>
      </div>

      <div id="warning" class="warning" hidden></div>
    </section>

    <section class="card">
      <h2>Filter form</h2>
      <div class="formula">
        y<sub>k</sub> =
        N<sub>0</sub>u<sub>k</sub> + N<sub>1</sub>u<sub>k-1</sub> + N<sub>2</sub>u<sub>k-2</sub>
        − D<sub>1</sub>y<sub>k-1</sub> − D<sub>2</sub>y<sub>k-2</sub>
      </div>
      <p class="hint">
        Note: this is the common “biquad” difference equation. For 1st order, N<sub>2</sub>=0 and D<sub>2</sub>=0.
      </p>
    </section>

    <section class="card">
      <h2>Output</h2>

      <div class="out-head" id="outTitle">—</div>

      <div class="table-wrap">
        <table class="coeff">
          <thead>
            <tr><th>Coeff</th><th>Value</th></tr>
          </thead>
          <tbody>
            <tr><td>N0</td><td><code id="n0">—</code></td></tr>
            <tr><td>N1</td><td><code id="n1">—</code></td></tr>
            <tr><td>N2</td><td><code id="n2">—</code></td></tr>
            <tr><td>D1</td><td><code id="d1">—</code></td></tr>
            <tr><td>D2</td><td><code id="d2">—</code></td></tr>
          </tbody>
        </table>
      </div>

      <h3>Copyable block</h3>
      <pre id="outText" class="pre">—</pre>
    </section>

    <footer class="footer">
      <span>Offline PWA • Works on phone • Bilinear transform (prewarped)</span>
    </footer>
  </main>

  <script src="app.js"></script>
  <script>
    // Register service worker (PWA offline)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try { await navigator.serviceWorker.register('./service-worker.js'); } catch (_) {}
      });
    }
  </script>
</body>
</html>
